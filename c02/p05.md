# vim搜索与替换

##### vim替换举例：

命令模式下：

命令：`:1,100s/IPTABLES/iptables/g`

- 将`1~100`行的IPTABLES替换为iptables
- `g`代表全局的(不加的话每行最多只能替换一次)
-  若这些行中没有IPTABLES，则会有提示"找不到模式IPTABLES"

命令：`:1,1s/huiny//g`

- 删除1~1行的huiny字符串

- 按`:`后，可以`向上方向键`或者`向下方向键`找以前使用过的命令(有命令历史)



问题：希望将`/etc/sysconfig/`替换为其他字符串（如`111`）时，怎么弄(字符串里含`/`)?

1. 加`\`脱意符，如`:1,$s/\/etc\/sysconfig\//11111/g`

2. 用`#`号代替原`/`，如：`:1,$s#/etc/sysconfig/#1111#g`



##### 一般模式下的查找与替换：

`/word`：向光标之后寻找一个字符串名为word的字符串，当找到第一个word后，按`n`继续搜后一个，按`N`继续搜前一个

`?word`：向光标之前寻找一个字符串名为word的字符串，当找到第一个word后，按`n`继续搜前一个，按`N`继续搜后一个

`:n1,n2s/word1/word2/g`：在n1和n2行间查找word1这个字符串并替换为word2，你也可以把`/`换成`#`

`:1,$s/word1/word2/g` ：从第一行到最末行，查找word1并替换成word2

`:1,$s/word1/word2/gc`：加上c的作用是，在替换前需要用户确认

`*`：查找当前光标下的单词，按`n`继续搜后一个，按`N`继续搜前一个



##### 命令模式相关命令：

| 命令               | 含义                                                         |
| :----------------- | :----------------------------------------------------------- |
| w                  | 将编辑过的文本保存                                           |
| :w!                | 若文本属性为只读时，强制保存                                 |
| :q                 | 退出vim                                                      |
| :q!                | 不管编辑或未编辑都不保存退出                                 |
| :wq                | 保存，退出                                                   |
| :e!                | 将文档还原成最原始状态                                       |
| ZZ                 | 若文档没有改动，则不储存离开，若文档改动过，则储存后离开，等同于:wq |
| :w [filename]      | 编辑后的文档另存为filename                                   |
| :r [filename]      | 在当前光标所在行的下面读入filename文档的内容                 |
| `:set nu`          | 在每行的行首显示行号                                         |
| `:set nonu`        | 取消行号                                                     |
| n1,n2 w [filename] | 将n1到n2的内容另存为filename这个文档                         |
| `:! command`       | 暂时离开vim运行某个linux命令，例如 `:! ls ~` 暂时列出当前用户家目录下的文件，然后会提示按回车回到vim |
| `:x`               | 写入文件并退出。仅当文件被修改时才写入，并更新文件修改时间，否则不会更新文件修改时间。 |



##### vim 在当前目录下递归搜索某字符串，并打开quickfix

文档链接：<https://blog.csdn.net/YAOZHENGUO2006/article/details/72861676>

```shell

:vim {pattern} ** |copen
```
